# Process Description - ระบบ Portfolio Management

## หน้า Personal Information Details (รายละเอียดข้อมูลส่วนตัว)

### ภาพรวมกระบวนการ
หน้านี้แสดงรายละเอียดข้อมูลส่วนตัวของนักศึกษา พร้อมข้อมูลการศึกษาและผลงาน Portfolio ที่ได้รับการอนุมัติแล้ว

---

## ตาราง Process Description

| ขั้นตอน | ชื่อกระบวนการ | คำอธิบาย | ข้อมูลนำเข้า | ข้อมูลส่งออก | ตารางที่เกี่ยวข้อง | เงื่อนไข |
|---------|---------------|----------|-------------|-------------|------------------|----------|
| 1 | **เข้าสู่ระบบ** | ผู้ใช้เข้าสู่ระบบผ่านการล็อกอิน | email, password | session_id, user_id | users, sessions | ผู้ใช้ต้องมีบัญชีและรหัสผ่านถูกต้อง |
| 2 | **ตรวจสอบสิทธิ์** | ระบบตรวจสอบสิทธิ์การเข้าถึงข้อมูล | user_id, role | permission_status | users | ผู้ใช้ต้องเป็นเจ้าของข้อมูลหรือ admin |
| 3 | **ดึงข้อมูลส่วนตัว** | ระบบดึงข้อมูลส่วนตัวจากฐานข้อมูล | user_id, personal_info_id | ข้อมูลส่วนตัวทั้งหมด | personal_info, users | ข้อมูลต้องมีสถานะ approved |
| 4 | **แสดงข้อมูลส่วนตัว** | แสดงข้อมูลพื้นฐานของผู้ใช้ | ข้อมูลจากขั้นตอน 3 | ชื่อ-นามสกุล, อายุ, เพศ, สถานะ | personal_info | ข้อมูลต้องครบถ้วน |
| 5 | **แสดงข้อมูลการศึกษา** | แสดงข้อมูลการศึกษาของผู้ใช้ | ข้อมูลจากขั้นตอน 3 | คณะ, สาขา, ระดับการศึกษา | personal_info | ข้อมูลการศึกษาต้องมีอยู่ |
| 6 | **ดึงข้อมูล Portfolio** | ระบบดึงข้อมูล Portfolio ที่เกี่ยวข้อง | personal_info_id | ข้อมูล Portfolio | personal_info | Portfolio ต้องมีไฟล์และรูปปก |
| 7 | **แสดงผลงาน Portfolio** | แสดงหน้าปกและรายละเอียด Portfolio | ข้อมูลจากขั้นตอน 6 | รูปปก, ชื่อผู้จัดทำ, สถาบัน, ปี | personal_info | ไฟล์รูปต้องมีอยู่และแสดงได้ |
| 8 | **แสดงไฟล์ PDF** | แสดงข้อมูลไฟล์ PDF Portfolio | ข้อมูลจากขั้นตอน 6 | ชื่อไฟล์ PDF | personal_info | ไฟล์ PDF ต้องมีอยู่ |
| 9 | **บันทึกการเข้าชม** | บันทึกสถิติการเข้าชมหน้า | user_id, page_url, session_id | analytics record | analytics | บันทึกทุกครั้งที่มีการเข้าชม |

---

## รายละเอียดกระบวนการ

### 1. การเข้าสู่ระบบ (Authentication)
- **วัตถุประสงค์**: ตรวจสอบตัวตนผู้ใช้
- **ข้อมูลที่ต้องการ**: อีเมลและรหัสผ่าน
- **การทำงาน**: ระบบตรวจสอบข้อมูลกับตาราง `users`
- **ผลลัพธ์**: สร้าง session และกำหนดสิทธิ์การเข้าถึง

### 2. การตรวจสอบสิทธิ์ (Authorization)
- **วัตถุประสงค์**: ตรวจสอบสิทธิ์การเข้าถึงข้อมูลส่วนตัว
- **เงื่อนไข**: 
  - เจ้าของข้อมูลสามารถดูข้อมูลของตนเองได้
  - Admin สามารถดูข้อมูลของทุกคนได้
- **การทำงาน**: เปรียบเทียบ user_id กับข้อมูลที่ต้องการดู

### 3. การดึงข้อมูล (Data Retrieval)
- **ตารางหลัก**: `personal_info`
- **เงื่อนไข**: สถานะต้องเป็น 'approved'
- **ข้อมูลที่ดึง**:
  - ข้อมูลส่วนตัว: ชื่อ, อายุ, เพศ
  - ข้อมูลการศึกษา: คณะ, สาขา
  - ข้อมูล Portfolio: รูปปก, ไฟล์ PDF

### 4. การแสดงผล (Display)
- **รูปแบบการแสดง**:
  - ข้อมูลส่วนตัว: แสดงในกล่องข้อมูล
  - สถานะ: แสดงด้วยสี (เขียว = อนุมัติ)
  - เพศ: แสดงด้วยสี (แดง = หญิง)
  - Portfolio: แสดงรูปปกและรายละเอียด

### 5. การบันทึกสถิติ (Analytics)
- **เหตุการณ์**: page_view
- **ข้อมูลที่บันทึก**: user_id, page_url, timestamp
- **วัตถุประสงค์**: ติดตามการใช้งานและสร้างรายงาน

---

## Business Rules (กฎทางธุรกิจ)

### 1. การเข้าถึงข้อมูล
- ผู้ใช้สามารถดูข้อมูลของตนเองได้เท่านั้น
- Admin สามารถดูข้อมูลของทุกคนได้
- ข้อมูลที่ยังไม่ได้รับการอนุมัติจะไม่แสดง

### 2. การแสดงผล
- สถานะ 'อนุมัติแล้ว' แสดงด้วยสีเขียว
- เพศ 'หญิง' แสดงด้วยสีแดง
- ข้อมูลที่ขาดหายไปจะไม่แสดง

### 3. การจัดการไฟล์
- รูปปก Portfolio ต้องแสดงได้
- ไฟล์ PDF ต้องมีอยู่และสามารถดาวน์โหลดได้
- ชื่อไฟล์จะแสดงในรูปแบบที่อ่านได้

---

## Error Handling (การจัดการข้อผิดพลาด)

| สถานการณ์ | การจัดการ | ข้อความแสดงผล |
|-----------|-----------|---------------|
| ไม่พบข้อมูลส่วนตัว | แสดงข้อความ "ไม่พบข้อมูล" | "ไม่พบข้อมูลส่วนตัว" |
| ไฟล์รูปเสียหาย | แสดงรูปเริ่มต้น | รูปเริ่มต้นของระบบ |
| ไม่มีสิทธิ์เข้าถึง | Redirect ไปหน้า 403 | "คุณไม่มีสิทธิ์เข้าถึงหน้านี้" |
| ข้อมูลยังไม่ได้รับการอนุมัติ | แสดงสถานะ "รอการอนุมัติ" | "ข้อมูลกำลังรอการอนุมัติ" |

---

## Performance Considerations (การพิจารณาประสิทธิภาพ)

### 1. การโหลดข้อมูล
- ใช้ Eager Loading สำหรับข้อมูลที่เกี่ยวข้อง
- Cache ข้อมูลที่เปลี่ยนแปลงน้อย
- Optimize การดึงรูปภาพ

### 2. การแสดงผล
- Lazy Loading สำหรับรูปภาพขนาดใหญ่
- Compress รูปภาพก่อนแสดง
- ใช้ CDN สำหรับไฟล์สาธารณะ

---

## Security Considerations (การพิจารณาความปลอดภัย)

### 1. การเข้าถึงข้อมูล
- ตรวจสอบสิทธิ์ทุกครั้งที่เข้าถึงข้อมูล
- ใช้ CSRF Protection
- Validate ข้อมูลนำเข้า

### 2. การจัดการไฟล์
- ตรวจสอบประเภทไฟล์
- จำกัดขนาดไฟล์
- ใช้ชื่อไฟล์ที่ปลอดภัย

---

*เอกสารนี้สร้างขึ้นสำหรับหน้า Personal Information Details ของระบบ Portfolio Management*
